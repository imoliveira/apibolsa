apiVersion: v1
kind: ConfigMap
metadata:
  name: mysql-init-script
  namespace: apibolsa
  labels:
    app.kubernetes.io/name: mysql
    app.kubernetes.io/part-of: apibolsa
data:
  init.sql: |
    -- Script de inicialização do MySQL para API Bolsa
    CREATE DATABASE IF NOT EXISTS loginapibolsaDB CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
    CREATE USER IF NOT EXISTS 'teste'@'%' IDENTIFIED BY 'teste';
    GRANT ALL PRIVILEGES ON loginapibolsaDB.* TO 'teste'@'%';
    FLUSH PRIVILEGES;
    USE loginapibolsaDB;
    CREATE TABLE IF NOT EXISTS usuarios (
        id INT AUTO_INCREMENT PRIMARY KEY,
        username VARCHAR(100) UNIQUE NOT NULL,
        password_hash VARCHAR(255) NOT NULL,
        email VARCHAR(255),
        nome_completo VARCHAR(255),
        ativo BOOLEAN DEFAULT TRUE,
        criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        atualizado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
        ultimo_login TIMESTAMP NULL
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
    CREATE INDEX IF NOT EXISTS idx_username ON usuarios(username);



